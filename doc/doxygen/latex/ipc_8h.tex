\hypertarget{ipc_8h}{}\section{ipc.\+h File Reference}
\label{ipc_8h}\index{ipc.\+h@{ipc.\+h}}


Manage communication between different instance of smartfolder.  


This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=182pt]{ipc_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef void($\ast$ {\bfseries ipc\+\_\+stop\+\_\+callback}) (void $\ast$)\hypertarget{ipc_8h_a411bc98eff907bee7fb3371d08bf48db}{}\label{ipc_8h_a411bc98eff907bee7fb3371d08bf48db}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{ipc_8h_a869a843644acd5eab7270099bc112a69}{ipc\+\_\+set\+\_\+watch} (char $\ast$dst\+\_\+path, ipc\+\_\+stop\+\_\+callback cb, void $\ast$cb\+\_\+arg)
\begin{DoxyCompactList}\small\item\em Create the instance run file for further identification by other instances, and setup signal catch. \end{DoxyCompactList}\item 
int \hyperlink{ipc_8h_a4f14d264fa040d8103d6e7a2f6088f44}{ipc\+\_\+remove\+\_\+watch} (char $\ast$dst\+\_\+path)
\begin{DoxyCompactList}\small\item\em Removes the watch file for the given search path. \end{DoxyCompactList}\item 
int \hyperlink{ipc_8h_a3cbaa8bad6fdc71f32bb803d628fcf25}{ipc\+\_\+stop\+\_\+watch} (char $\ast$dst\+\_\+path)
\begin{DoxyCompactList}\small\item\em Stop the instance designated by the given search path, using the S\+I\+G\+T\+E\+RM signal. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Manage communication between different instance of smartfolder. 

In order to do this, during initialisation (ipc\+\_\+set\+\_\+watch), it create a file in the user home directory and put the P\+ID of the current instance in it. The name of this file is constructed by taking the provided destination path and replacing all directory separator by an underscore.

It also setup two signals catch (S\+I\+G\+I\+NT and S\+I\+G\+T\+E\+RM) for cleanup purpose. The callback and callback data are provided by the caller, and stored as global for usage in the signl handler. This is this handler that also remove the file in the user home directory.

Now, to terminate an instance, it gets the P\+ID of the target instance by getting it in the concerned file. To get this file, it does the same string replacement in the provided destination folder to have the right name. Then, with the P\+ID, it launch a S\+I\+G\+T\+E\+RM signal to the instance.

When a signal is received, the signal handler will first remove the file and call the callback if any.

\begin{DoxyAuthor}{Author}
Claudio Sousa, Gonzalez David 
\end{DoxyAuthor}


\subsection{Function Documentation}
\index{ipc.\+h@{ipc.\+h}!ipc\+\_\+remove\+\_\+watch@{ipc\+\_\+remove\+\_\+watch}}
\index{ipc\+\_\+remove\+\_\+watch@{ipc\+\_\+remove\+\_\+watch}!ipc.\+h@{ipc.\+h}}
\subsubsection[{\texorpdfstring{ipc\+\_\+remove\+\_\+watch(char $\ast$dst\+\_\+path)}{ipc_remove_watch(char *dst_path)}}]{\setlength{\rightskip}{0pt plus 5cm}int ipc\+\_\+remove\+\_\+watch (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{dst\+\_\+path}
\end{DoxyParamCaption}
)}\hypertarget{ipc_8h_a4f14d264fa040d8103d6e7a2f6088f44}{}\label{ipc_8h_a4f14d264fa040d8103d6e7a2f6088f44}


Removes the watch file for the given search path. 


\begin{DoxyParams}{Parameters}
{\em dst\+\_\+path} & The destination path that designate the instance \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error indicator\+: 0 for OK, 1 for an error 
\end{DoxyReturn}


Definition at line 132 of file ipc.\+c.

\index{ipc.\+h@{ipc.\+h}!ipc\+\_\+set\+\_\+watch@{ipc\+\_\+set\+\_\+watch}}
\index{ipc\+\_\+set\+\_\+watch@{ipc\+\_\+set\+\_\+watch}!ipc.\+h@{ipc.\+h}}
\subsubsection[{\texorpdfstring{ipc\+\_\+set\+\_\+watch(char $\ast$dst\+\_\+path, ipc\+\_\+stop\+\_\+callback cb, void $\ast$cb\+\_\+arg)}{ipc_set_watch(char *dst_path, ipc_stop_callback cb, void *cb_arg)}}]{\setlength{\rightskip}{0pt plus 5cm}int ipc\+\_\+set\+\_\+watch (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{dst\+\_\+path, }
\item[{ipc\+\_\+stop\+\_\+callback}]{cb, }
\item[{void $\ast$}]{cb\+\_\+arg}
\end{DoxyParamCaption}
)}\hypertarget{ipc_8h_a869a843644acd5eab7270099bc112a69}{}\label{ipc_8h_a869a843644acd5eab7270099bc112a69}


Create the instance run file for further identification by other instances, and setup signal catch. 


\begin{DoxyParams}{Parameters}
{\em dst\+\_\+path} & The destination path this instance operates on \\
\hline
{\em cb} & Callback when a stop signal is received \\
\hline
{\em cb\+\_\+arg} & Callback argument \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error indicator\+: 0 for OK, 1 for an error 
\end{DoxyReturn}


Definition at line 92 of file ipc.\+c.

\index{ipc.\+h@{ipc.\+h}!ipc\+\_\+stop\+\_\+watch@{ipc\+\_\+stop\+\_\+watch}}
\index{ipc\+\_\+stop\+\_\+watch@{ipc\+\_\+stop\+\_\+watch}!ipc.\+h@{ipc.\+h}}
\subsubsection[{\texorpdfstring{ipc\+\_\+stop\+\_\+watch(char $\ast$dst\+\_\+path)}{ipc_stop_watch(char *dst_path)}}]{\setlength{\rightskip}{0pt plus 5cm}int ipc\+\_\+stop\+\_\+watch (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{dst\+\_\+path}
\end{DoxyParamCaption}
)}\hypertarget{ipc_8h_a3cbaa8bad6fdc71f32bb803d628fcf25}{}\label{ipc_8h_a3cbaa8bad6fdc71f32bb803d628fcf25}


Stop the instance designated by the given search path, using the S\+I\+G\+T\+E\+RM signal. 


\begin{DoxyParams}{Parameters}
{\em dst\+\_\+path} & The destination path that designate the instance \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error indicator\+: 0 for OK, 1 for an error 
\end{DoxyReturn}


Definition at line 146 of file ipc.\+c.

