<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Search folder: ipc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Search folder
   </div>
   <div id="projectbrief">System programming semester project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ipc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manage communication between different instance of smartfolder.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="ipc_8h__dep__incl.png" border="0" usemap="#ipc_8hdep" alt=""/></div>
<map name="ipc_8hdep" id="ipc_8hdep">
<area shape="rect" id="node2" href="ipc_8c.html" title="Manage communication between different instance of smartfolder. " alt="" coords="5,80,56,107"/>
<area shape="rect" id="node3" href="main_8c.html" title="Main program: deamonise, parse argument and launch the search. " alt="" coords="80,80,141,107"/>
</map>
</div>
</div>
<p><a href="ipc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a411bc98eff907bee7fb3371d08bf48db"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a411bc98eff907bee7fb3371d08bf48db"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><b>ipc_stop_callback</b>) (void *)</td></tr>
<tr class="separator:a411bc98eff907bee7fb3371d08bf48db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a869a843644acd5eab7270099bc112a69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ipc_8h.html#a869a843644acd5eab7270099bc112a69">ipc_set_watch</a> (char *dst_path, ipc_stop_callback cb, void *cb_arg)</td></tr>
<tr class="memdesc:a869a843644acd5eab7270099bc112a69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the instance run file for further identification by other instances, and setup signal catch.  <a href="#a869a843644acd5eab7270099bc112a69">More...</a><br /></td></tr>
<tr class="separator:a869a843644acd5eab7270099bc112a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f14d264fa040d8103d6e7a2f6088f44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ipc_8h.html#a4f14d264fa040d8103d6e7a2f6088f44">ipc_remove_watch</a> (char *dst_path)</td></tr>
<tr class="memdesc:a4f14d264fa040d8103d6e7a2f6088f44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the watch file for the given search path.  <a href="#a4f14d264fa040d8103d6e7a2f6088f44">More...</a><br /></td></tr>
<tr class="separator:a4f14d264fa040d8103d6e7a2f6088f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cbaa8bad6fdc71f32bb803d628fcf25"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ipc_8h.html#a3cbaa8bad6fdc71f32bb803d628fcf25">ipc_stop_watch</a> (char *dst_path)</td></tr>
<tr class="memdesc:a3cbaa8bad6fdc71f32bb803d628fcf25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the instance designated by the given search path, using the SIGTERM signal.  <a href="#a3cbaa8bad6fdc71f32bb803d628fcf25">More...</a><br /></td></tr>
<tr class="separator:a3cbaa8bad6fdc71f32bb803d628fcf25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manage communication between different instance of smartfolder. </p>
<p>In order to do this, during initialisation (ipc_set_watch), it create a file in the user home directory and put the PID of the current instance in it. The name of this file is constructed by taking the provided destination path and replacing all directory separator by an underscore.</p>
<p>It also setup two signals catch (SIGINT and SIGTERM) for cleanup purpose. The callback and callback data are provided by the caller, and stored as global for usage in the signl handler. This is this handler that also remove the file in the user home directory.</p>
<p>Now, to terminate an instance, it gets the PID of the target instance by getting it in the concerned file. To get this file, it does the same string replacement in the provided destination folder to have the right name. Then, with the PID, it launch a SIGTERM signal to the instance.</p>
<p>When a signal is received, the signal handler will first remove the file and call the callback if any.</p>
<dl class="section author"><dt>Author</dt><dd>Claudio Sousa, Gonzalez David </dd></dl>

<p>Definition in file <a class="el" href="ipc_8h_source.html">ipc.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4f14d264fa040d8103d6e7a2f6088f44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ipc_remove_watch </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes the watch file for the given search path. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst_path</td><td>The destination path that designate the instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error indicator: 0 for OK, 1 for an error </dd></dl>

<p>Definition at line <a class="el" href="ipc_8c_source.html#l00132">132</a> of file <a class="el" href="ipc_8c_source.html">ipc.c</a>.</p>

</div>
</div>
<a class="anchor" id="a869a843644acd5eab7270099bc112a69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ipc_set_watch </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ipc_stop_callback&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cb_arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create the instance run file for further identification by other instances, and setup signal catch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst_path</td><td>The destination path this instance operates on </td></tr>
    <tr><td class="paramname">cb</td><td>Callback when a stop signal is received </td></tr>
    <tr><td class="paramname">cb_arg</td><td>Callback argument </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error indicator: 0 for OK, 1 for an error </dd></dl>

<p>Definition at line <a class="el" href="ipc_8c_source.html#l00092">92</a> of file <a class="el" href="ipc_8c_source.html">ipc.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3cbaa8bad6fdc71f32bb803d628fcf25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ipc_stop_watch </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the instance designated by the given search path, using the SIGTERM signal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst_path</td><td>The destination path that designate the instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error indicator: 0 for OK, 1 for an error </dd></dl>

<p>Definition at line <a class="el" href="ipc_8c_source.html#l00146">146</a> of file <a class="el" href="ipc_8c_source.html">ipc.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
